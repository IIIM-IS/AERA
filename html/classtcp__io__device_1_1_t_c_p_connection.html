<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AERA: tcp_io_device::TCPConnection Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AERA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>tcp_io_device</b></li><li class="navelem"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html">TCPConnection</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classtcp__io__device_1_1_t_c_p_connection-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tcp_io_device::TCPConnection Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="tcp__connection_8h_source.html">tcp_connection.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a90c7d0bf43dc11d7c2e18963e1a04365"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#a90c7d0bf43dc11d7c2e18963e1a04365">TCPConnection</a> (std::shared_ptr&lt; <a class="el" href="classtcp__io__device_1_1_safe_queue.html">SafeQueue</a> &gt; receive_queue, std::shared_ptr&lt; <a class="el" href="classtcp__io__device_1_1_safe_queue.html">SafeQueue</a> &gt; send_queue, uint64_t msg_length_buf_size)</td></tr>
<tr class="separator:a90c7d0bf43dc11d7c2e18963e1a04365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f1eecfabb9eaca78c02413fc15544ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#a9f1eecfabb9eaca78c02413fc15544ba">establishConnection</a> (std::string port)</td></tr>
<tr class="separator:a9f1eecfabb9eaca78c02413fc15544ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a420506b904a4034a930ea55f4954c710"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#a420506b904a4034a930ea55f4954c710">start</a> ()</td></tr>
<tr class="separator:a420506b904a4034a930ea55f4954c710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29140209448c2cfb7d4ceb1eccb78f32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#a29140209448c2cfb7d4ceb1eccb78f32">stop</a> ()</td></tr>
<tr class="separator:a29140209448c2cfb7d4ceb1eccb78f32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad967048c1a74c3149ca75b6d83855aac"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#ad967048c1a74c3149ca75b6d83855aac">isRunning</a> ()</td></tr>
<tr class="separator:ad967048c1a74c3149ca75b6d83855aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:ad36fd2eddc1fd02b82d948345b18c4f2"><td class="memItemLeft" align="right" valign="top"><a id="ad36fd2eddc1fd02b82d948345b18c4f2"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>State</b> { <b>NOT_STARTED</b> = 0, 
<b>RUNNING</b> = 1, 
<b>STOPPED</b> = 2
 }</td></tr>
<tr class="separator:ad36fd2eddc1fd02b82d948345b18c4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad1eda9dea3bc1c47d3a226c7a210994e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#ad1eda9dea3bc1c47d3a226c7a210994e">tcpBackgroundHandler</a> ()</td></tr>
<tr class="separator:ad1eda9dea3bc1c47d3a226c7a210994e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf0663da349d650a0b286446e3bb40c7"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TCPMessage &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#aaf0663da349d650a0b286446e3bb40c7">receiveMessage</a> ()</td></tr>
<tr class="separator:aaf0663da349d650a0b286446e3bb40c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5426be925c05c29e55fdd3b57330a5f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html#a5426be925c05c29e55fdd3b57330a5f5">sendMessage</a> (std::unique_ptr&lt; TCPMessage &gt; msg)</td></tr>
<tr class="separator:a5426be925c05c29e55fdd3b57330a5f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:acc8eaee6906558378e45246b8bb75cba"><td class="memItemLeft" align="right" valign="top"><a id="acc8eaee6906558378e45246b8bb75cba"></a>
<a class="el" href="class_state.html">State</a>&#160;</td><td class="memItemRight" valign="bottom"><b>state_</b></td></tr>
<tr class="separator:acc8eaee6906558378e45246b8bb75cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe0393e880fd03cc642d9d966e0da044"><td class="memItemLeft" align="right" valign="top"><a id="abe0393e880fd03cc642d9d966e0da044"></a>
std::shared_ptr&lt; std::thread &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>tcp_background_thread_</b></td></tr>
<tr class="separator:abe0393e880fd03cc642d9d966e0da044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb33d77182fb590a26f3e8378444c10d"><td class="memItemLeft" align="right" valign="top"><a id="aeb33d77182fb590a26f3e8378444c10d"></a>
FD_SET&#160;</td><td class="memItemRight" valign="bottom"><b>tcp_client_fd_set_</b></td></tr>
<tr class="separator:aeb33d77182fb590a26f3e8378444c10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf0fbf55ab83996b9c7585c8b8764442"><td class="memItemLeft" align="right" valign="top"><a id="adf0fbf55ab83996b9c7585c8b8764442"></a>
SOCKET&#160;</td><td class="memItemRight" valign="bottom"><b>tcp_client_socket_</b></td></tr>
<tr class="separator:adf0fbf55ab83996b9c7585c8b8764442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1302a0bd62e671f954b97b679ad16c5e"><td class="memItemLeft" align="right" valign="top"><a id="a1302a0bd62e671f954b97b679ad16c5e"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>msg_buf_size_</b></td></tr>
<tr class="separator:a1302a0bd62e671f954b97b679ad16c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8afacb664b9d3cdf2f966442f0d170"><td class="memItemLeft" align="right" valign="top"><a id="aab8afacb664b9d3cdf2f966442f0d170"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>msg_length_buf_size_</b></td></tr>
<tr class="separator:aab8afacb664b9d3cdf2f966442f0d170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0f101869eb2c3cb1d34a265f976370"><td class="memItemLeft" align="right" valign="top"><a id="aeb0f101869eb2c3cb1d34a265f976370"></a>
std::shared_ptr&lt; <a class="el" href="classtcp__io__device_1_1_safe_queue.html">SafeQueue</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>incoming_queue_</b></td></tr>
<tr class="separator:aeb0f101869eb2c3cb1d34a265f976370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c0cb84bfd96abb48ac4a3625b57331"><td class="memItemLeft" align="right" valign="top"><a id="aa4c0cb84bfd96abb48ac4a3625b57331"></a>
std::shared_ptr&lt; <a class="el" href="classtcp__io__device_1_1_safe_queue.html">SafeQueue</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>outgoing_queue_</b></td></tr>
<tr class="separator:aa4c0cb84bfd96abb48ac4a3625b57331"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html">TCPConnection</a> is used to pass data using Win-Sockets between the environment simulation and the <a class="el" href="classtcp__io__device_1_1_tcp_io_device.html">TcpIoDevice</a> object. It runs in a different thread and uses SafeQueues to pass data between the IODevice and the socket connection. </p>

<p class="definition">Definition at line <a class="el" href="tcp__connection_8h_source.html#l00114">114</a> of file <a class="el" href="tcp__connection_8h_source.html">tcp_connection.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a90c7d0bf43dc11d7c2e18963e1a04365"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90c7d0bf43dc11d7c2e18963e1a04365">&#9670;&nbsp;</a></span>TCPConnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tcp_io_device::TCPConnection::TCPConnection </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classtcp__io__device_1_1_safe_queue.html">SafeQueue</a> &gt;&#160;</td>
          <td class="paramname"><em>receive_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classtcp__io__device_1_1_safe_queue.html">SafeQueue</a> &gt;&#160;</td>
          <td class="paramname"><em>send_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>msg_length_buf_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor for the <a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html">TCPConnection</a> used in a seperate thread to communicate with the environment simulation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">receive_queue</td><td>The queue used to pass incoming messages to the <a class="el" href="classtcp__io__device_1_1_tcp_io_device.html">TcpIoDevice</a>. </td></tr>
    <tr><td class="paramname">send_queue</td><td>The queue used to pass outgoing messages from the <a class="el" href="classtcp__io__device_1_1_tcp_io_device.html">TcpIoDevice</a>. </td></tr>
    <tr><td class="paramname">msg_length_buf_size</td><td>The number of bytes used to store the message length of the serialized protobuf message (should be 8) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9f1eecfabb9eaca78c02413fc15544ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f1eecfabb9eaca78c02413fc15544ba">&#9670;&nbsp;</a></span>establishConnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_io_device::TCPConnection::establishConnection </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>port</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a socket to connect to a client on the passed port. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>The port used to communicate with the client. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad967048c1a74c3149ca75b6d83855aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad967048c1a74c3149ca75b6d83855aac">&#9670;&nbsp;</a></span>isRunning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_io_device::TCPConnection::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true if the <a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html">TCPConnection</a> is running. </p><dl class="section return"><dt>Returns</dt><dd>true if running, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tcp__connection_8h_source.html#l00147">147</a> of file <a class="el" href="tcp__connection_8h_source.html">tcp_connection.h</a>.</p>

</div>
</div>
<a id="aaf0663da349d650a0b286446e3bb40c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf0663da349d650a0b286446e3bb40c7">&#9670;&nbsp;</a></span>receiveMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TCPMessage&gt; tcp_io_device::TCPConnection::receiveMessage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to receive data from the socket and parse them into a TCPMessage </p><dl class="section return"><dt>Returns</dt><dd>A unique_ptr to a TCPMessage for enqueuing it into the receive_queue_. </dd></dl>

</div>
</div>
<a id="a5426be925c05c29e55fdd3b57330a5f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5426be925c05c29e55fdd3b57330a5f5">&#9670;&nbsp;</a></span>sendMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_io_device::TCPConnection::sendMessage </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; TCPMessage &gt;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Converts a message to a byte-stream and sends it to the client. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The TCPMessage to send. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes sent. If &lt;= 0 an error occured while sending the message. </dd></dl>

</div>
</div>
<a id="a420506b904a4034a930ea55f4954c710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a420506b904a4034a930ea55f4954c710">&#9670;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_io_device::TCPConnection::start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Starts the communication between environment simulation (client) and the <a class="el" href="classtcp__io__device_1_1_t_c_p_connection.html">TCPConnection</a> (server). </p>

</div>
</div>
<a id="a29140209448c2cfb7d4ceb1eccb78f32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29140209448c2cfb7d4ceb1eccb78f32">&#9670;&nbsp;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_io_device::TCPConnection::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stops the communication </p>

</div>
</div>
<a id="ad1eda9dea3bc1c47d3a226c7a210994e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1eda9dea3bc1c47d3a226c7a210994e">&#9670;&nbsp;</a></span>tcpBackgroundHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_io_device::TCPConnection::tcpBackgroundHandler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handles the TCP connection in the background by checking for new outgoing and incoming messages, dequeueing and enqueueing the SafeQueues, respectively. Repeatedly checks for new messages on the socket and parses them to TCPMessage objects. Takes TCPMessage objects from the outgoing_queue_ and parses them into a byte-stream to send to the client. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="tcp__connection_8h_source.html">tcp_connection.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
